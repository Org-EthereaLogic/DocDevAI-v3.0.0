name: "Work Breakdown Structure (WBS) Generation"
description: "Generate comprehensive Work Breakdown Structure from PRD and project requirements"
category: "generation"
version: "1.0.0"

# Define what inputs this template needs
inputs:
  - name: "prd_document"
    type: "document"
    required: false
    description: "Generated PRD document if available"
    
  - name: "project_description"
    type: "string"
    required: true
    description: "Project description and requirements"
    
  - name: "project_name"
    type: "string"
    required: true
    description: "Name of the project"
    
  - name: "team_size"
    type: "string"
    required: false
    default: "small team (3-5 developers)"
    description: "Size and composition of development team"
    
  - name: "duration"
    type: "string"
    required: false
    default: "3-6 months"
    description: "Expected project duration"
    
  - name: "methodology"
    type: "string"
    required: false
    default: "Agile/Scrum"
    description: "Development methodology"

# LLM configuration for multi-provider synthesis
llm_config:
  providers:
    - name: "openai"
      weight: 0.4
      model: "gpt-4-turbo-preview"
    - name: "claude"
      weight: 0.35
      model: "claude-3-opus-20240229"
    - name: "google"
      weight: 0.25
      model: "gemini-pro"
  
  temperature: 0.6
  max_tokens: 10000

# The actual prompt template
prompt:
  system: |
    You are an experienced Project Manager and Work Breakdown Structure (WBS) expert with 
    deep knowledge of project decomposition, task estimation, and resource planning. You 
    excel at breaking down complex projects into manageable, hierarchical work packages.
    
    Your WBS documents are:
    - Hierarchically organized with clear parent-child relationships
    - 100% complete (all work is accounted for)
    - Mutually exclusive (no overlapping work)
    - Include clear deliverables and milestones
    - Have realistic time and effort estimates
    - Follow the 8/80 rule (work packages between 8-80 hours)
    - Include proper WBS numbering (1.0, 1.1, 1.1.1, etc.)
  
  user: |
    Create a comprehensive Work Breakdown Structure (WBS) for {{project_name}} that 
    decomposes all project work into manageable tasks.
    
    <project_description>
    {{project_description}}
    </project_description>
    
    {% if prd_document %}
    <prd_reference>
    {{prd_document}}
    </prd_reference>
    {% endif %}
    
    Team Size: {{team_size}}
    Duration: {{duration}}
    Methodology: {{methodology}}
    
    Generate a detailed WBS with the following structure:
    
    <wbs>
    # {{project_name}} - Work Breakdown Structure (WBS)
    
    ## Project Overview
    - **Project Name:** {{project_name}}
    - **Duration:** {{duration}}
    - **Team Size:** {{team_size}}
    - **Methodology:** {{methodology}}
    - **WBS Type:** Deliverable-oriented
    - **Total Estimated Effort:** [Calculate total person-hours]
    
    ## WBS Dictionary Legend
    - **ID:** WBS number (e.g., 1.2.3)
    - **Level:** Hierarchy level (1-5)
    - **Type:** Work Package (WP), Summary Task (ST), Milestone (MS)
    - **Effort:** Estimated person-hours
    - **Duration:** Calendar time
    - **Dependencies:** Prerequisite tasks
    - **Deliverable:** Tangible output
    
    ## Work Breakdown Structure
    
    ### 1.0 {{project_name}} [LEVEL 1 - PROJECT]
    **Type:** Project Summary
    **Total Effort:** [Sum of all work]
    **Duration:** {{duration}}
    **Deliverable:** Complete {{project_name}} system
    
    #### 1.1 Project Management [LEVEL 2 - PHASE]
    **Type:** Summary Task
    **Effort:** [10-15% of total project effort]
    **Duration:** Entire project
    **Deliverable:** Project documentation and governance
    
    ##### 1.1.1 Project Planning [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 40 hours
    **Duration:** 1 week
    **Dependencies:** None
    **Deliverable:** Project plan, WBS, schedule
    **Tasks:**
    - Create project charter (8h)
    - Develop WBS (8h)
    - Create project schedule (16h)
    - Define communication plan (8h)
    
    ##### 1.1.2 Risk Management [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 24 hours
    **Duration:** Ongoing
    **Dependencies:** 1.1.1
    **Deliverable:** Risk register and mitigation plans
    **Tasks:**
    - Identify risks (8h)
    - Assess risk probability and impact (8h)
    - Develop mitigation strategies (8h)
    
    ##### 1.1.3 Stakeholder Management [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 32 hours
    **Duration:** Ongoing
    **Dependencies:** 1.1.1
    **Deliverable:** Stakeholder engagement plan
    **Tasks:**
    - Identify stakeholders (4h)
    - Stakeholder analysis (8h)
    - Communication planning (8h)
    - Regular stakeholder updates (12h)
    
    ##### 1.1.4 Project Monitoring & Control [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 60 hours
    **Duration:** Entire project
    **Dependencies:** 1.1.1
    **Deliverable:** Status reports, change logs
    **Tasks:**
    - Weekly status meetings (30h)
    - Progress tracking (15h)
    - Change management (15h)
    
    #### 1.2 Requirements & Design [LEVEL 2 - PHASE]
    **Type:** Summary Task
    **Effort:** [Estimated hours]
    **Duration:** [Timeframe]
    **Deliverable:** Complete requirements and design documentation
    
    ##### 1.2.1 Requirements Gathering [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 80 hours
    **Duration:** 2 weeks
    **Dependencies:** 1.1.1
    **Deliverable:** Requirements specification document
    **Tasks:**
    - Stakeholder interviews (24h)
    - Requirements workshops (16h)
    - Document functional requirements (24h)
    - Document non-functional requirements (16h)
    
    ##### 1.2.2 System Architecture Design [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 60 hours
    **Duration:** 1.5 weeks
    **Dependencies:** 1.2.1
    **Deliverable:** Architecture design document
    **Tasks:**
    - High-level architecture (16h)
    - Component design (20h)
    - Data model design (16h)
    - Integration design (8h)
    
    ##### 1.2.3 UI/UX Design [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 48 hours
    **Duration:** 1 week
    **Dependencies:** 1.2.1
    **Deliverable:** UI mockups and style guide
    **Tasks:**
    - User flow diagrams (8h)
    - Wireframes (16h)
    - High-fidelity mockups (16h)
    - Style guide creation (8h)
    
    #### 1.3 Development [LEVEL 2 - PHASE]
    **Type:** Summary Task
    **Effort:** [Largest portion of effort]
    **Duration:** [Core development time]
    **Deliverable:** Working software system
    
    ##### 1.3.1 Environment Setup [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 24 hours
    **Duration:** 3 days
    **Dependencies:** 1.2.2
    **Deliverable:** Development environment
    **Tasks:**
    - Setup version control (4h)
    - Configure CI/CD pipeline (12h)
    - Setup development servers (8h)
    
    ##### 1.3.2 Backend Development [LEVEL 3 - SUMMARY]
    **Type:** Summary Task
    **Effort:** [Calculated from sub-tasks]
    **Duration:** [Timeframe]
    **Deliverable:** Complete backend system
    
    ###### 1.3.2.1 Database Implementation [LEVEL 4 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 40 hours
    **Duration:** 1 week
    **Dependencies:** 1.2.2, 1.3.1
    **Deliverable:** Database schema and migrations
    
    ###### 1.3.2.2 API Development [LEVEL 4 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 120 hours
    **Duration:** 3 weeks
    **Dependencies:** 1.3.2.1
    **Deliverable:** RESTful API endpoints
    
    ###### 1.3.2.3 Business Logic Implementation [LEVEL 4 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 160 hours
    **Duration:** 4 weeks
    **Dependencies:** 1.3.2.1
    **Deliverable:** Core business logic modules
    
    ##### 1.3.3 Frontend Development [LEVEL 3 - SUMMARY]
    **Type:** Summary Task
    **Effort:** [Calculated from sub-tasks]
    **Duration:** [Timeframe]
    **Deliverable:** Complete frontend application
    
    ###### 1.3.3.1 UI Component Development [LEVEL 4 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 80 hours
    **Duration:** 2 weeks
    **Dependencies:** 1.2.3, 1.3.1
    **Deliverable:** Reusable UI components
    
    ###### 1.3.3.2 Page Implementation [LEVEL 4 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 120 hours
    **Duration:** 3 weeks
    **Dependencies:** 1.3.3.1
    **Deliverable:** All application pages
    
    ###### 1.3.3.3 Frontend-Backend Integration [LEVEL 4 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 60 hours
    **Duration:** 1.5 weeks
    **Dependencies:** 1.3.2.2, 1.3.3.2
    **Deliverable:** Integrated application
    
    #### 1.4 Testing [LEVEL 2 - PHASE]
    **Type:** Summary Task
    **Effort:** [20-30% of development effort]
    **Duration:** [Overlaps with development]
    **Deliverable:** Tested and validated system
    
    ##### 1.4.1 Unit Testing [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 80 hours
    **Duration:** Continuous
    **Dependencies:** 1.3.2, 1.3.3
    **Deliverable:** Unit test suite (>80% coverage)
    
    ##### 1.4.2 Integration Testing [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 60 hours
    **Duration:** 2 weeks
    **Dependencies:** 1.3.3.3
    **Deliverable:** Integration test suite
    
    ##### 1.4.3 System Testing [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 40 hours
    **Duration:** 1 week
    **Dependencies:** 1.4.2
    **Deliverable:** System test results
    
    ##### 1.4.4 User Acceptance Testing [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 40 hours
    **Duration:** 1 week
    **Dependencies:** 1.4.3
    **Deliverable:** UAT sign-off
    
    #### 1.5 Deployment [LEVEL 2 - PHASE]
    **Type:** Summary Task
    **Effort:** [Calculated]
    **Duration:** 1 week
    **Deliverable:** Production system
    
    ##### 1.5.1 Production Environment Setup [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 24 hours
    **Duration:** 3 days
    **Dependencies:** 1.4.4
    **Deliverable:** Production infrastructure
    
    ##### 1.5.2 Data Migration [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 16 hours
    **Duration:** 2 days
    **Dependencies:** 1.5.1
    **Deliverable:** Migrated production data
    
    ##### 1.5.3 Production Deployment [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 16 hours
    **Duration:** 2 days
    **Dependencies:** 1.5.2
    **Deliverable:** Live production system
    
    ##### 1.5.4 Post-Deployment Support [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 40 hours
    **Duration:** 2 weeks
    **Dependencies:** 1.5.3
    **Deliverable:** Stable production system
    
    #### 1.6 Documentation & Training [LEVEL 2 - PHASE]
    **Type:** Summary Task
    **Effort:** [Calculated]
    **Duration:** [Overlaps with development]
    **Deliverable:** Complete documentation and trained users
    
    ##### 1.6.1 Technical Documentation [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 40 hours
    **Duration:** 1 week
    **Dependencies:** 1.3.2, 1.3.3
    **Deliverable:** Technical documentation
    
    ##### 1.6.2 User Documentation [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 32 hours
    **Duration:** 1 week
    **Dependencies:** 1.4.3
    **Deliverable:** User guides and help docs
    
    ##### 1.6.3 Training Materials [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 24 hours
    **Duration:** 3 days
    **Dependencies:** 1.6.2
    **Deliverable:** Training materials and videos
    
    ##### 1.6.4 User Training [LEVEL 3 - WORK PACKAGE]
    **Type:** Work Package
    **Effort:** 16 hours
    **Duration:** 2 days
    **Dependencies:** 1.6.3, 1.5.3
    **Deliverable:** Trained end users
    
    ## Milestones
    
    | ID | Milestone | Target Date | Criteria |
    |----|-----------|------------|----------|
    | MS1 | Project Kickoff | Week 1 | Project plan approved |
    | MS2 | Requirements Complete | Week 3 | Requirements sign-off |
    | MS3 | Design Complete | Week 5 | Architecture approved |
    | MS4 | Alpha Release | Week 12 | Core features working |
    | MS5 | Beta Release | Week 16 | Feature complete |
    | MS6 | Production Release | Week 20 | UAT passed, deployed |
    | MS7 | Project Closure | Week 22 | Handover complete |
    
    ## Resource Allocation Matrix
    
    | Phase | % of Total Effort | Person-Hours | Team Members |
    |-------|------------------|--------------|--------------|
    | Project Management | 10% | [Calculated] | PM |
    | Requirements & Design | 15% | [Calculated] | All |
    | Development | 45% | [Calculated] | Developers |
    | Testing | 20% | [Calculated] | QA + Developers |
    | Deployment | 5% | [Calculated] | DevOps + Developers |
    | Documentation | 5% | [Calculated] | Tech Writer + Team |
    
    ## Critical Path
    [Identify the sequence of dependent tasks that determine minimum project duration]
    1.1.1 → 1.2.1 → 1.2.2 → 1.3.1 → 1.3.2.1 → 1.3.2.2 → 1.3.3.3 → 1.4.2 → 1.4.3 → 1.4.4 → 1.5.1 → 1.5.3
    
    ## Risk Factors
    - **Technical Complexity:** [Identify complex work packages]
    - **Dependencies:** [Critical external dependencies]
    - **Resource Constraints:** [Bottlenecks in team capacity]
    
    </wbs>
    
    <effort_summary>
    Provide effort summary:
    - Total Effort: [Sum all work package hours]
    - Total Duration: [Critical path duration]
    - Team Utilization: [Average utilization %]
    - Recommended Buffer: [Contingency recommendation]
    </effort_summary>
    
    <gantt_data>
    Generate Gantt chart data structure:
    - Task dependencies
    - Start and end dates
    - Resource assignments
    - Critical path highlighting
    </gantt_data>

# Output processing configuration
output:
  format: "structured"
  sections:
    - name: "wbs"
      type: "document"
      extract_tag: "wbs"
      save_as: "wbs.md"
      
    - name: "effort_summary"
      type: "analysis"
      extract_tag: "effort_summary"
      
    - name: "gantt_data"
      type: "data"
      extract_tag: "gantt_data"
      save_as: "gantt_data.json"

# MIAIR optimization settings
miair_config:
  enabled: true
  target_quality: 0.85
  max_iterations: 2
  focus_areas:
    - "completeness"
    - "accuracy"
    - "hierarchy"
    - "estimates"